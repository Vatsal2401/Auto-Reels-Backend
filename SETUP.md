# Quick Setup Guide

## ğŸš€ Fastest Way to Get Started

### Option 1: Automated Setup (Recommended)

```bash
# Run the setup script
npm run setup
```

This script will:
- âœ… Check prerequisites (Node.js, Docker)
- âœ… Install dependencies
- âœ… Create `.env` file from template
- âœ… Start PostgreSQL and Redis
- âœ… Wait for services to be ready
- âœ… Run database migrations

### Option 2: Manual Setup

1. **Install dependencies:**
```bash
npm install
```

2. **Create environment file:**
```bash
cp .env.example .env
# Edit .env with your API keys
```

3. **Start infrastructure:**
```bash
npm run infra:up
```

4. **Start the API:**
```bash
npm run start:dev
```

## ğŸ“‹ Prerequisites

- **Node.js 22+** - [Download](https://nodejs.org/)
- **Docker & Docker Compose** - [Download](https://www.docker.com/)
- **API Keys** (for full functionality):
  - OpenAI API key (for script generation & TTS)
  - AWS S3 credentials (for video storage)
  - Replicate API token (for captions)

## ğŸ”‘ Required Environment Variables

Minimum required for local development:

```env
# Database (auto-configured by Docker)
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=postgres
DB_DATABASE=ai_reels

# Redis (auto-configured by Docker)
REDIS_HOST=localhost
REDIS_PORT=6379

# JWT Secret (auto-generated by setup script)
JWT_SECRET=your-secret-key

# API Keys (add your own)
OPENAI_API_KEY=your_key_here
AWS_ACCESS_KEY_ID=your_key_here
AWS_SECRET_ACCESS_KEY=your_key_here
S3_BUCKET_NAME=your-bucket-name
REPLICATE_API_TOKEN=your_token_here
```

## ğŸ› ï¸ Development Commands

### Start Services

```bash
# Start API server (with hot reload)
npm run start:dev

# Start infrastructure (PostgreSQL + Redis)
npm run infra:up

# View infrastructure logs
npm run infra:logs

# Stop infrastructure
npm run infra:down
```

### Workers

Start workers in separate terminals:

```bash
npm run worker:orchestrator
npm run worker:script
npm run worker:audio
npm run worker:caption
npm run worker:asset
npm run worker:render
```

### Database

```bash
# Run migrations
npm run migration:run

# Revert last migration
npm run migration:revert

# Seed test data
npm run seed

# Reset database (revert + run + seed)
npm run db:reset
```

## ğŸ§ª Testing the Setup

1. **Check health:**
```bash
curl http://localhost:3000/health
```

2. **View API docs:**
Open http://localhost:3000/api-docs in your browser

3. **Test signup:**
```bash
curl -X POST http://localhost:3000/auth/signup \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "password123",
    "name": "Test User"
  }'
```

## ğŸ› Troubleshooting

### Port Already in Use

```bash
# Find and kill process on port 3000
lsof -ti:3000 | xargs kill -9

# Or change PORT in .env
PORT=3001
```

### Database Connection Failed

```bash
# Check if PostgreSQL is running
docker ps | grep postgres

# Restart infrastructure
npm run infra:down
npm run infra:up
```

### Redis Connection Failed

```bash
# Check if Redis is running
docker ps | grep redis

# Test Redis connection
docker exec -it $(docker ps -qf "name=redis") redis-cli ping
```

## ğŸ“š Next Steps

1. Add your API keys to `.env`
2. Start the API: `npm run start:dev`
3. Start workers (optional for testing)
4. Test endpoints using Swagger UI: http://localhost:3000/api-docs

## ğŸ¯ Quick Test Without Workers

You can test the API without starting workers:

1. Create a video (will be queued)
2. Check video status
3. Workers process jobs when started

Workers are only needed for actual video generation.
